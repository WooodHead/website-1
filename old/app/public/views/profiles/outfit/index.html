<article id="outfit-profile" ng-controller="OutfitProfileController">
    <div class="sk-three-bounce" ng-show="!loaded">
        <div class="sk-child sk-bounce1"></div>
        <div class="sk-child sk-bounce2"></div>
        <div class="sk-child sk-bounce3"></div>
        <p class="caption center-align">
            Loading - Large outfits may take a long time to load!
        </p>
    </div>
    <div ng-if="loaded">
        <div class="row row-no-margin center-align">
            <h1 class="header-no-margin {{ service.data.factionAbv }}-table-text">
                <span ng-if="service.data.tag">[{{ service.data.tag }}]</span>
                {{ service.data.name }}
            </h1>
            <p class="caption">
                All stats below are gathered from recorded alert metrics. Please report any bugs or feature requests to the PS2Alerts Issue Tracker on <a href="https://github.com/Maelstromeous/PS2Alerts" target="_blank">
                    Github <i class="fa fa-github"></i>
                </a>
            </p>
            <p>
                <a href="{{ config.baseUrl }}/profiles/outfit/{{service.data.id }}">
                    Permalink <i class="fa fa-chain"></i>
                </a>
            </p>
        </div>
        <div class="col l8 m12 s12 no-padding">
            <div ng-include="'views/profiles/outfit/stats.html'"></div>
        </div>
        <div class="col l4 m12 s12">
            <h4 class="center-align">
                {{ service.data.metrics.data.involved }} Alerts recorded for this outfit
            </h4>
            <p class="caption center-align">
                Please note, some very old alerts (less than ID 5,000) may not be fully compatible with the site, as new data was added since.
            </p>
            <table id="alert-list"></table>
        </div>
        <div class="row row-no-margin">
            <div class="col s12 center-align button-row">
                <p class="caption">
                    For full outfit statistics unrelated to alerts, here's the best sites. Please let the creators know PS2Alerts is linking them! <i class="fa fa-heart"></i>
                </p>
                <a
                    href="http://stats.dasanfall.com/ps2/outfit/{{ service.data.tag }}"
                    class="waves-effect waves-light btn ga-event"
                    target="_blank"
                    ga-campaign="Profiles - Players"
                    ga-action="External Links"
                    ga-label="Dasanfall">
                    Dasanfall <i class="fa fa-link"></i>
                </a>
                <a
                    href="http://ps2.fisu.pw/player/?name={{ service.data.tag | lowercase }}"
                    class="waves-effect waves-light btn ga-event"
                    target="_blank"
                    ga-campaign="Profiles - Players"
                    ga-action="External Links"
                    ga-label="Fisu">
                    Fisu <i class="fa fa-link"></i>
                </a>
                <a
                    href="http://www.voidwell.com/#/ps2/outfit/{{ service.data.id }}"
                    class="waves-effect waves-light btn ga-event"
                    target="_blank"
                    ga-campaign="Profiles - Players"
                    ga-action="External Links"
                    ga-label="Voidwell">
                    Voidwell <i class="fa fa-link"></i>
                </a>
                <a
                    href="https://www.planetside2.com/players/#!/outfits/?outfit={{ service.data.id }}"
                    class="waves-effect waves-light btn ga-event"
                    target="_blank"
                    ga-campaign="Profiles - Players"
                    ga-action="External Links"
                    ga-label="Planetside 2">
                    PS2 Players <i class="fa fa-link"></i>
                </a>
            </div>
        </div>
        <div class="row row-no-margin">
            <div class="col m6 s12">
                <h2 class="center-align">
                    Players
                </h2>
                <h4 class="center-align">
                    {{ service.data.players.data.length }} players detected playing alerts
                </h4>
                <p class="caption center-align">
                    Only shows current members in the outfit
                </p>
                <table id="player-list"></table>
            </div>
            <div class="col m6 s12">
                <h2 class="center-align">
                    Facility Captures
                </h2>
                <h4 class="center-align">
                    {{ service.metrics.captures | number: 0 }} captures and {{ service.metrics.defences | number: 0 }} defences recorded
                </h4>
                <p class="caption center-align">
                    Defence values are inflated due to the way the game calculates a defence <a
                        href="#"
                        class="tooltipped"
                        data-tooltip="To the games API, a defence is counted whenever a facility has no countdown or has all points secured. Defences are counted for an outfit only when they own the base. If the base they own gets defended, it counts, regardless who's there."
                        data-position="top">
                        <i class="fa fa-info-circle"></i></a>
                </p>
                <table id="facility-list"></table>
            </div>
        </div>
    </div>
</article>
